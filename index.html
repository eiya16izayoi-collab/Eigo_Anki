<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>abceed Style Spelling Test</title>
    <style>
        :root { --primary-color: #48bb78; --bg-color: #f8fafc; --card-bg: #ffffff; --text-main: #2d3748; }
        body { font-family: 'Helvetica Neue', Arial, sans-serif; background-color: var(--bg-color); color: var(--text-main); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        #app { width: 100%; max-width: 400px; padding: 20px; box-sizing: border-box; }
        .card { background: var(--card-bg); border-radius: 24px; padding: 32px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); text-align: center; }
        .progress-container { width: 100%; height: 6px; background: #edf2f7; border-radius: 10px; margin-bottom: 30px; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: var(--primary-color); transition: width 0.3s ease; }
        .question-word { font-size: 32px; font-weight: 800; margin-bottom: 24px; color: #1a202c; }
        input[type="text"] { width: 100%; padding: 16px; font-size: 18px; border: 2px solid #e2e8f0; border-radius: 16px; text-align: center; margin-bottom: 20px; box-sizing: border-box; outline: none; }
        input[type="text"]:focus { border-color: var(--primary-color); }
        .btn-main { width: 100%; padding: 16px; background: var(--primary-color); color: white; border: none; border-radius: 16px; cursor: pointer; font-size: 18px; font-weight: bold; }
        #result-message { font-size: 20px; font-weight: bold; margin-bottom: 15px; min-height: 1.5em; }
        .wrong-item { text-align: left; padding: 12px; border-bottom: 1px solid #edf2f7; display: flex; justify-content: space-between; }
        .exit-link { margin-top: 25px; display: block; color: #a0aec0; font-size: 14px; text-decoration: none; cursor: pointer; }
    </style>
</head>
<body>

<div id="app">
    <div id="ui-header" style="display:none;">
        <div class="progress-container"><div id="progress-bar"></div></div>
    </div>

    <div id="start-screen" class="card">
        <div style="background: #e6fffa; color: #38a169; width: 60px; height: 60px; line-height: 60px; border-radius: 50%; margin: 0 auto 20px; font-weight: bold; font-size: 24px;">A</div>
        <h1 style="font-size: 24px; margin-bottom: 8px;">Spelling Master</h1>
        <p style="color: #718096; margin-bottom: 32px;">日本語 ➔ 英語スペル</p>
        <button class="btn-main" onclick="startApp()">特訓を開始する</button>
    </div>

    <div id="quiz-screen" class="card" style="display:none;">
        <div id="word-count" style="font-size: 12px; color: #a0aec0; margin-bottom: 10px;">0 / 0</div>
        <div class="question-word" id="word-display">...</div>
        <input type="text" id="user-input" placeholder="English spelling..." autocomplete="off">
        <div id="result-message"></div>
        <button id="action-btn" class="btn-main" onclick="handleAction()">判定する</button>
        <a class="exit-link" onclick="showResult()">途中で辞める</a>
    </div>

    <div id="result-screen" class="card" style="display:none;">
        <h2 style="margin-top:0;">学習の記録</h2>
        <div id="score-display" style="font-size: 40px; font-weight: bold; color: var(--primary-color); margin: 20px 0;">0%</div>
        <p id="stats-text" style="color: #718096; margin-bottom: 24px;"></p>
        <div id="wrong-area" style="display:none; text-align: left;">
            <p style="font-weight: bold; font-size: 14px; color: #e53e3e; border-bottom: 2px solid #fff5f5; padding-bottom: 8px;">要復習リスト</p>
            <div id="wrong-list" style="max-height: 200px; overflow-y: auto;"></div>
        </div>
        <button class="btn-main" onclick="location.reload()" style="margin-top:24px; background: #4a5568;">TOPに戻る</button>
    </div>
</div>

<script>
// 【日本語, 英語】の順に直しました！
const rawData = `
かろうじて,barely
から〜を奪う,deprive
隔たり・隙間,gap
障害（物）,obstacles
呼吸、息,breath
しぐさ、身ぶり,gesture
うなずき、会釈,nod
を(急に強く)つかむ,seize
を伸ばす、引っ張る,stretch
どなる、わめく,yell
を逮捕する,arrest
を犯す,commit
有罪の,guilty
事件,incident
罪のない、無罪の,innocent
留置所,jail
刑務所,prison
証拠,proof
自殺(的行為),suicide
目撃者・証人,witness
豊富な,abundant
量・額,amount
(を)計算する,calculate
(〜に)等しい,equal
過剰,excess
多数の,numerous
割合,proportion
分量・数量,quantity
合計の,total
量・容積、((1巻)),volume
目的地,destination
出発する,depart
港,port
案内人・ガイド,guide
天国,heaven
狩り,hunt
(宇宙)旅行,voyage
予約する,reserve
休む,rest
を取り消す,cancel
減少する,decrease
を拡大する,expand
を延長する,extend
を制限する,restrict
増加する,rise
わきへ,aside
端・ふち,edges
内部の,internal
近くの,nearby
表面,surface
一般の,general
抽象的な,abstract
複雑な,complex
穏やかな,mild
わかりやすい,plain
とがった,sharp
種類,sort
標準・基準,standards
平凡な,ordinary
程度,extent
並外れた,extraordinary
極端な,extreme
非常に,highly
ばく大な,huge
信じられない(ほどの),incredible
強烈な、激しい,intense
深刻な,severe
最初の,initial
順番,sequence
ひと続き,series
欠席して(いる),absent
声に出して,aloud
に出席する,attend
を教育する,educate
施設・設備,facilities
研究所,institute
奨学金,scholarship
勝利,victory
トーナメント,tournament
を負かす,defeat
房,bunch
ダース,dozen
あたり,per
ポンド,pounds
1枚,sheet
現在の,current
以前の,former
最近,lately
前の,previous
を思い出す,recall
雰囲気,atmosphere
～行きの,bound
地区,district
出口,exit
基礎・土台,foundation
を囲む,surround
利点、利益,benefits
奇跡,miracle
(を)克服する,overcome
進歩,progress
むき出しの,bare
あごひげ,beard
細胞,cells
肺,lung
筋肉,muscle
器官,organ
酸素,oxygen
肌,skin
魂,souls
視力,vision
式,ceremony
正式な,formal
機会・場合,occasion
(に)参加する,participate
出席している,present
賞,prize
商業的な,commercial
サービス,service
を建設する,construct
を輸送する,transport
`;

const allWords = rawData.trim().split('\n').map(line => {
    const [jp, en] = line.split(',');
    return { jp: jp.trim(), en: en.trim() };
});

let currentList = [];
let currentIndex = 0;
let correctCount = 0;
let wrongItems = [];
let isAnswered = false;

function startApp() {
    currentList = [...allWords].sort(() => Math.random() - 0.5);
    currentIndex = 0; correctCount = 0; wrongItems = [];
    document.getElementById('start-screen').style.display = "none";
    document.getElementById('quiz-screen').style.display = "block";
    document.getElementById('ui-header').style.display = "block";
    setupQuestion();
}

function setupQuestion() {
    isAnswered = false;
    const item = currentList[currentIndex];
    document.getElementById('word-display').innerText = item.jp;
    document.getElementById('word-count').innerText = `${currentIndex + 1} / ${currentList.length}`;
    document.getElementById('user-input').value = "";
    document.getElementById('user-input').disabled = false;
    document.getElementById('result-message').innerText = "";
    document.getElementById('action-btn').innerText = "判定する";
    document.getElementById('action-btn').style.background = "#48bb78";
    
    const progress = ((currentIndex) / currentList.length) * 100;
    document.getElementById('progress-bar').style.width = `${progress}%`;
    setTimeout(() => document.getElementById('user-input').focus(), 10);
}

function handleAction() {
    if (!isAnswered) checkAnswer();
    else nextQuestion();
}

document.getElementById('user-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') handleAction();
});

function checkAnswer() {
    const userAns = document.getElementById('user-input').value.trim().toLowerCase();
    const correctAns = currentList[currentIndex].en.toLowerCase();
    const msg = document.getElementById('result-message');
    const btn = document.getElementById('action-btn');
    
    isAnswered = true;
    document.getElementById('user-input').disabled = true;
    btn.innerText = "次へ";
    btn.style.background = "#4a5568";

    if (userAns === correctAns) {
        msg.innerText = "Excellent!";
        msg.style.color = "#38a169";
        correctCount++;
    } else {
        msg.innerHTML = `<span style="font-size:14px; color:#a0aec0;">正解:</span><br>${currentList[currentIndex].en}`;
        msg.style.color = "#e53e3e";
        wrongItems.push(currentList[currentIndex]);
    }
}

function nextQuestion() {
    currentIndex++;
    if (currentIndex < currentList.length) setupQuestion();
    else showResult();
}

function showResult() {
    document.getElementById('quiz-screen').style.display = "none";
    document.getElementById('ui-header').style.display = "none";
    document.getElementById('result-screen').style.display = "block";
    const solved = isAnswered ? currentIndex + 1 : currentIndex;
    const percent = solved === 0 ? 0 : Math.round((correctCount / solved) * 100);
    document.getElementById('score-display').innerText = `${percent}%`;
    document.getElementById('stats-text').innerText = `${solved}問中 ${correctCount}問正解`;
    if (wrongItems.length > 0) {
        document.getElementById('wrong-area').style.display = "block";
        const list = document.getElementById('wrong-list');
        list.innerHTML = wrongItems.map(item => `
            <div class="wrong-item">
                <span style="font-weight:bold;">${item.jp}</span>
                <span style="color:#718096;">${item.en}</span>
            </div>
        `).join('');
    }
}
</script>
</body>
</html>
